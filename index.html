<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ANIMAX PRO</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({ appId: "fdac3928-a2fc-4bc7-9541-cb85ae026409" });
      });
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- FULLSCREEN SEARCH OVERLAY -->
    <div id="search-overlay">
        <div class="search-header-box">
            <i class="fas fa-search search-icon-left"></i>
            <input type="text" id="search-input" placeholder="Search anime, movies..." autocomplete="off">
            <i class="fas fa-times search-close-btn" onclick="closeSearch()"></i>
        </div>
        <div class="search-results-title">Search Results</div>
        <div id="search-results" class="search-grid">
            <div class="empty-search">Type something to search...</div>
        </div>
    </div>

    <!-- AUTH SCREEN -->
    <div id="auth-screen" style="display: none;">
        <div class="auth-brand">ANIMAX <span>PRO</span></div>
        <div class="auth-content">
            <h1 class="auth-headline">Unlimited<br><span>Anime & Movies</span></h1>
            <p class="auth-subhead">Watch anywhere. Cancel anytime.</p>

            <div class="auth-card" id="login-form">
                <input type="email" id="email-in" class="custom-input" placeholder="Email Address">
                <input type="password" id="pass-in" class="custom-input" placeholder="Password">
                <button class="btn-primary" onclick="handleAuth('login')">Sign In</button>
                <div class="auth-footer">New to Animax? <span onclick="toggleAuth()">Sign up now</span></div>
            </div>

            <div class="auth-card" id="reg-form" style="display:none;">
                <input type="email" id="remail-in" class="custom-input" placeholder="Email Address">
                <input type="password" id="rpass-in" class="custom-input" placeholder="Create Password">
                <button class="btn-primary" onclick="handleAuth('reg')">Register</button>
                <div class="auth-footer">Already a user? <span onclick="toggleAuth()">Sign In</span></div>
            </div>
        </div>
    </div>

    <!-- MAIN HOME APP -->
    <div id="main-app" class="app-view" style="display: block; padding-top: 0;">
        <header class="glass-header">
            <div class="logo">ANIMAX <span>PRO</span></div>
            <div class="header-icon" onclick="openSearch()"><i class="fas fa-search"></i></div>
        </header>

        <!-- Fixed Hero Banner -->
        <div id="hero-banner" class="hero-container">
            <!-- Dynamically loaded via JS -->
        </div>

        <div id="ad-banner-top" class="ad-container-center" style="margin-top: 20px;"></div>
        
        <div class="row-container">
            <div class="row-header">
                <h3><i class="fas fa-fire" style="color:#ff4757;"></i> Trending Now</h3>
                <span>See All</span>
            </div>
            <div class="horizontal-scroll" id="trending-row"></div>
        </div>

        <div class="row-container">
            <div class="row-header">
                <h3><i class="fas fa-bolt" style="color:var(--gold);"></i> New Releases</h3>
            </div>
            <div class="horizontal-scroll" id="new-row"></div>
        </div>

        <div class="dev-footer">CRAFTED BY RJ ROCKY</div>
    </div>

    <!-- MOVIE BOX VIEW -->
    <div id="movie-box-view" class="app-view" style="padding-top: 0;">
        <header class="glass-header">
            <div class="logo">MOVIE <span>BOX</span></div>
            <div style="display:flex; gap:15px;">
                <div class="header-icon" onclick="openSearch()"><i class="fas fa-search"></i></div>
                <div class="header-icon" onclick="switchInterface('main')" style="color: #ff4757;"><i class="fas fa-times"></i></div>
            </div>
        </header>
        
        <div id="movie-hero" class="hero-container">
             <!-- Dynamically loaded via JS -->
        </div>

        <div class="row-container">
            <div class="row-header">
                <h3><i class="fas fa-film" style="color:#ff4757;"></i> Blockbuster Movies</h3>
            </div>
            <div class="movie-grid" id="movie-grid"></div>
        </div>
    </div>

    <!-- PLAYER VIEW (ADVANCED) -->
    <div id="player-view">
        <div class="video-wrapper">
            <div class="back-btn-player" onclick="closePlayer()">
                <i class="fas fa-chevron-left"></i>
            </div>
            <video id="main-video" controls playsinline></video>
        </div>

        <div class="player-meta-container">
            <div class="meta-title" id="player-title">Episode Title</div>
            <div class="meta-tags">
                <span class="tag-match">98% Match</span>
                <span class="tag-year">2024</span>
                <span class="tag-hd">HD</span>
                <span id="content-type-badge">Anime</span>
            </div>

            <div class="action-buttons-row">
                <div class="act-btn-large" id="like-btn" onclick="toggleLike()">
                    <i class="fas fa-plus"></i>
                    <span>My List</span>
                </div>
                <div class="act-btn-large" onclick="shareContent()">
                    <i class="fas fa-paper-plane"></i>
                    <span>Share</span>
                </div>
                <div class="act-btn-large">
                    <i class="fas fa-download"></i>
                    <span>Download</span>
                </div>
            </div>

            <div class="resources-section">
                <select id="season-select" onchange="switchSeason(this.value)" class="season-dropdown"></select>
                <div class="ep-grid" id="episode-pill-container"></div>
            </div>

            <div class="tab-header">
                <!-- Changed Text Here -->
                <div class="tab-item active" id="tab-btn-foryou" onclick="switchPlayerTab('foryou')">For You</div>
                <div class="tab-item" id="tab-btn-comments" onclick="switchPlayerTab('comments')">Comments</div>
            </div>

            <div id="tab-content-foryou">
                <!-- Changed Grid Class Here -->
                <div class="grid-3-col" id="dynamic-rec-grid" style="margin-top: 15px;"></div>
                <div id="ad-banner-player" class="ad-container-center"></div>
            </div>

            <div id="tab-content-comments" style="display: none; padding-top:15px;">
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="comment-input" class="comment-input" placeholder="Add a comment...">
                    <button class="comment-btn" onclick="postComment()"><i class="fas fa-paper-plane"></i></button>
                </div>
                <div id="comments-list"></div>
            </div>
        </div>
    </div>

    <!-- SHORTS VIEW -->
    <div id="shorts-view" style="display:none;">
        <div class="back-btn-player" style="position:fixed; top:20px; left:20px; z-index:101;" onclick="hideShorts()">
            <i class="fas fa-arrow-left"></i>
        </div>
        <div id="shorts-container"></div>
    </div>

    <!-- ROYAL PROFILE VIEW (Restored Design) -->
    <div id="profile-view" class="app-view" style="background:#050505; height:100vh; overflow-y:auto; padding-top:0;">
        <div class="profile-bg-header">
            <div style="position:absolute; top:20px; right:20px; color:var(--gold); font-size:20px;" onclick="auth.signOut()">
                <i class="fas fa-sign-out-alt"></i>
            </div>
            <div class="royal-avatar-container">
                <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="royal-avatar-img">
            </div>
        </div>

        <div class="royal-info-card">
            <h2 id="profile-name" style="font-family:'Orbitron'; font-size:22px; letter-spacing:1px; text-shadow:0 0 10px rgba(255,255,255,0.3);">USER</h2>
            <div id="vip-badge" class="royal-badge">FREE ACCOUNT</div>
        </div>

        <div style="margin-top: 25px;">
            <div class="telegram-card" onclick="window.open('https://t.me/animax090', '_blank')">
                <div style="display:flex; align-items:center; gap:15px;">
                    <i class="fab fa-telegram-plane" style="font-size:32px; color:#fff;"></i>
                    <div style="text-align:left;">
                        <h4 style="font-family:'Orbitron'; color:#fff; font-size:14px;">JOIN COMMUNITY</h4>
                        <p style="color:rgba(255,255,255,0.8); font-size:10px;">Official Updates & Requests</p>
                    </div>
                </div>
                <i class="fas fa-chevron-right" style="color:#fff;"></i>
            </div>
        </div>

        <div class="menu-grid">
            <div class="royal-menu-btn" onclick="switchInterface('movie')">
                <i class="fas fa-film" style="color:#ff3b3b"></i>
                <span>Movie Box</span>
            </div>
            <div class="royal-menu-btn" onclick="openHistory()">
                <i class="fas fa-history"></i>
                <span>Watch History</span>
            </div>
            <div class="royal-menu-btn" onclick="alert('Locker Coming Soon!')">
                <i class="fas fa-lock"></i>
                <span>VIP Locker</span>
            </div>
            <div class="royal-menu-btn" onclick="document.querySelector('.premium-area').scrollIntoView({behavior:'smooth'})">
                <i class="fas fa-crown"></i>
                <span>Get Premium</span>
            </div>
        </div>

        <div class="premium-area" style="padding:20px; margin-bottom:80px;">
            <div style="background:linear-gradient(135deg, #1a1a1a, #000); border:1px solid var(--gold); padding:20px; border-radius:15px; position:relative; overflow:hidden;">
                <div style="position:absolute; top:-20px; right:-20px; width:100px; height:100px; background:radial-gradient(circle, var(--gold) 0%, transparent 70%); opacity:0.2;"></div>
                
                <h4 style="color:var(--gold); font-family:'Orbitron'; margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:10px;">
                    <i class="fas fa-gem"></i> REDEEM CODE
                </h4>
                
                <input type="text" id="prem-code" placeholder="Enter License Key" 
                       style="background:rgba(0,0,0,0.5); border:1px solid #444; color:#fff; width:100%; padding:12px; border-radius:8px; margin-bottom:10px;">
                
                <button onclick="redeemCode()" style="width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: 700; background: linear-gradient(45deg, #AA8C2C, #D4AF37); color: #000; font-family: 'Orbitron'; cursor: pointer; letter-spacing: 1px;">ACTIVATE PREMIUM</button>
                
                <button onclick="buyPremium()" style="width:100%; background:transparent; border:1px solid #333; color:#888; padding:10px; margin-top:10px; border-radius:8px; font-size:11px;">
                    Purchase Subscription
                </button>
            </div>
        </div>
    </div>

    <!-- HISTORY VIEW -->
    <div id="history-view">
        <div class="history-header">
            <h2>My List & History</h2>
            <i class="fas fa-times" onclick="closeHistory()"></i>
        </div>
        <div id="history-list-container" style="padding: 20px;"></div>
    </div>

    <!-- BOTTOM FLOATING NAVBAR -->
    <nav id="main-nav">
        <div class="nav-item active" onclick="switchTab('home')" data-tab="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="nav-item" onclick="showShorts()" data-tab="shorts">
            <i class="fas fa-play"></i>
            <span>Shorts</span>
        </div>
        <div class="nav-item" onclick="switchTab('profile')" data-tab="profile">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </div>
    </nav>

    <script src="app.js"></script>
</body>
            </html>
